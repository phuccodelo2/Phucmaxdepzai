-- üìå RSPY NPC Only + UI Copy Code
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local HttpService = game:GetService("HttpService")
local UIS = game:GetService("UserInputService")

-- UI Setup
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Parent = game.CoreGui

local Frame = Instance.new("Frame")
Frame.Size = UDim2.new(0, 400, 0, 250)
Frame.Position = UDim2.new(0.3, 0, 0.3, 0)
Frame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
Frame.BorderSizePixel = 0
Frame.Parent = ScreenGui
Frame.Active = true
Frame.Draggable = true

local Title = Instance.new("TextLabel")
Title.Size = UDim2.new(1, 0, 0, 30)
Title.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
Title.Text = "üõ† NPC RSPY"
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.Font = Enum.Font.SourceSansBold
Title.TextSize = 20
Title.Parent = Frame

local LogBox = Instance.new("TextBox")
LogBox.Size = UDim2.new(1, -10, 1, -70)
LogBox.Position = UDim2.new(0, 5, 0, 35)
LogBox.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
LogBox.TextColor3 = Color3.fromRGB(0, 255, 0)
LogBox.TextXAlignment = Enum.TextXAlignment.Left
LogBox.TextYAlignment = Enum.TextYAlignment.Top
LogBox.ClearTextOnFocus = false
LogBox.MultiLine = true
LogBox.TextWrapped = false
LogBox.Font = Enum.Font.Code
LogBox.TextSize = 15
LogBox.Parent = Frame

local CopyBtn = Instance.new("TextButton")
CopyBtn.Size = UDim2.new(1, -10, 0, 30)
CopyBtn.Position = UDim2.new(0, 5, 1, -35)
CopyBtn.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
CopyBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
CopyBtn.Text = "üìã Copy Code"
CopyBtn.Font = Enum.Font.SourceSansBold
CopyBtn.TextSize = 18
CopyBtn.Parent = Frame

CopyBtn.MouseButton1Click:Connect(function()
    if setclipboard then
        setclipboard(LogBox.Text)
    end
end)

-- Hook Remote ch·ªâ NPC
local mt = getrawmetatable(game)
setreadonly(mt, false)
local oldNamecall = mt.__namecall

mt.__namecall = newcclosure(function(self, ...)
    local method = getnamecallmethod()
    local args = {...}

    -- Ki·ªÉm tra n·∫øu object thu·ªôc NPC (kh√¥ng ph·∫£i Player)
    local parentModel = self:FindFirstAncestorOfClass("Model")
    if parentModel and not Players:GetPlayerFromCharacter(parentModel) then
        if method == "FireServer" or method == "InvokeServer" then
            local info = {}
            pcall(function()
                info = {
                    RemotePath = self:GetFullName(),
                    Method = method,
                    Arguments = args
                }
            end)
            local log = string.format(
                "-- üìå %s g·ªçi %s\nlocal remote = game.%s\nremote:%s(%s)\n",
                parentModel.Name,
                method,
                self:GetFullName(),
                method,
                table.concat(
                    table.create(#args, function(i)
                        return HttpService:JSONEncode(args[i])
                    end),
                    ", "
                )
            )
            LogBox.Text = LogBox.Text .. "\n" .. log
        end
    end
    return oldNamecall(self, ...)
end)
